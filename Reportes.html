<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles2.css">
    <title>Reportes</title>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <img src="data/logo1.webp">
            </div>
            <nav class="menu">
                <!--<a target="_blank" href="index.html">
                    <img src="img/icon1.png">Inicio</a>-->
                <label for="btn-modal">
                    <a>Cerrar Sesión</a>
                </label>
            </nav>
        </div>
    </header>

    <main class="content">
        <h1>Subir Imágenes</h1>
        <form id="uploadForm">
            <input type="file" id="fileInput" name="fileInput" accept="image/*" multiple onchange="displayFileInfo()">
            <div id="imagePreview"></div>
            <button type="button" onclick="submitForm()">Descargar Excel</button>
        </form>
        <div id="result"></div>
    </main>

    <script>
        let imagesData = [];

        function displayFileInfo() {
            const fileInput = document.getElementById('fileInput');
            const imagePreview = document.getElementById('imagePreview');

            // Limpiar cualquier imagen previa
            imagePreview.innerHTML = '';
            imagesData = [];

            // Mostrar las imágenes previas y guardar los datos
            for (const file of fileInput.files) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.createElement('img');
                    img.src = event.target.result;
                    img.style.maxWidth = '200px'; // Ajustar el tamaño de la imagen según sea necesario
                    imagePreview.appendChild(img);
                };
                reader.readAsDataURL(file);

                // Guardar los datos del archivo
                const fileName = file.name;
                const currentDateTime = new Date().toLocaleString('es-ES');
                imagesData.push({ fileName, currentDateTime });
            }
        }

        function submitForm() {
            // Crear el contenido CSV
            let csvContent = "data:text/csv;charset=utf-8,";

            // Encabezados del archivo CSV
            csvContent += "Nombre del archivo,Fecha y hora\n";

            // Agregar datos de cada imagen a la lista CSV
            imagesData.forEach(image => {
                csvContent += `${image.fileName},${image.currentDateTime}\n`;
            });

            // Crear un elemento de enlace para descargar el archivo CSV
            const link = document.createElement('a');
            link.setAttribute('href', encodeURI(csvContent));
            link.setAttribute('download', 'reporte.csv');
            document.body.appendChild(link);

            // Simular clic en el enlace para descargar el archivo
            link.click();
        }
    </script>
</body>
</html>
